[![Pipeline](https://github.com/NicolasEzequielZulaicaRivera/aninfo_squad_2_2022_1c/actions/workflows/pipeline.yml/badge.svg?branch=master)](https://github.com/NicolasEzequielZulaicaRivera/aninfo_squad_2_2022_1c/actions/workflows/pipeline.yml)
[![](https://img.shields.io/badge/python-3.9-blue.svg)](https://www.python.org/downloads/)
[![](https://img.shields.io/badge/docs-fastapi-blue.svg)](https://fastapi.tiangolo.com/)


# PSA - M√≥dulo de proyectos

## Links

- [üóÉÔ∏è Squad Drive](https://drive.google.com/drive/folders/1tgJLJsmCotfn_13ujyAJihNR38PKLGJT)
- [üë• Tribe Repo](https://github.com/NicolasEzequielZulaicaRivera/aninfo_tribu_1_2022_1c)

## Installing the project

The only dependency required to use this template is [poetry](https://python-poetry.org). The recommended method to install it is through [pip](https://pypi.org/project/pip/).

```bash
$ pip3 install poetry
$ poetry config virtualenvs.in-project true
```

Remember to commit to the repo the `poetry.lock` file generated by `poetry install`.

### Initiating the venv

```bash
$ poetry shell
```

## Dependencies

The virtual environment is automatically created and activated via poetry.

```bash 
$ cd to-project-path
$ poetry install
```

To make sure everything is set up correctly, run the following command which must show the virtual environment path:

```bash 
$ poetry show -v
```

### Adding new dependencies

Check the [full poetry docs](https://python-poetry.org/docs/cli/), but here goes a quick reminder,

```bash
$ poetry add <dependency> [--dev]
```

## Docker

You need [docker-compose](https://docs.docker.com/compose/) and [docker](https://docs.docker.com/) to run the following containers
and commands.

### Developing with container and database

```bash
$ sudo ./scripts/test-container.sh
```

### Running tests within container

You have two options here, one is simple running:

```bash
$ sudo ./scripts/execute-test-container.sh
```

which will execute all the tests and will exit the container afterwards.

Alternately, you can also run a container which will run the app and will provide the database. In one terminal run:

```bash
$ sudo ./scripts/test-container.sh
```

Then in other terminal run `docker ps` and copy the `container ID` from the `docker_fastapi-server` image:

```bash
$ docker ps
CONTAINER ID   IMAGE                   COMMAND                  CREATED              STATUS              PORTS                                       NAMES
b1e9c7c4e040   docker_fastapi-server   "./docker-entrypoint‚Ä¶"   About a minute ago   Up About a minute   0.0.0.0:8082->8082/tcp, :::8082->8082/tcp   docker_fastapi-server_1
620c0b75ce2a   postgres:13             "docker-entrypoint.s‚Ä¶"   About a minute ago   Up About a minute   0.0.0.0:5438->5432/tcp, :::5438->5432/tcp   docker_postgres_1
```

Finally, enter the container with `docker exec -it [container-id] bash` and run the tests within the container using `poetry run pytest`:

```bash
$ docker exec -it [container-id] bash
root@b1e9c7c4e040:/code# ls
docker-entrypoint.sh  poetry.lock  pyproject.toml  src  tests
$ poetry run pytest
```



### Style guide

This template follows [PEP8](https://www.python.org/dev/peps/pep-0008/).

For this purpose, we use:

- [black](https://github.com/psf/black): an opinionated code formatting tool
- [flake8](https://github.com/PyCQA/flake8): a tool to enforce style guide
- [pylint](https://github.com/PyCQA/pylint): a source code, bug and quality checker

**Linters**

```bash
$ flake8 && pylint <module_name>
```

```bash
$ flake8 . && pylint src
```

**Formatter**

```bash
$ black .
```


